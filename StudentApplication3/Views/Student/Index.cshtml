@model List<StudentApplication3.Models.Student>
@{
    ViewBag.Title = "Index";
}

<h2>Student Management</h2>
<a href="@Url.Action("Create", "Student")">Add New Student</a>

<table id="studentGrid"></table>
<div id="pager"></div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/free-jqgrid/4.15.5/jquery.jqgrid.min.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/free-jqgrid/4.15.5/css/ui.jqgrid.min.css" />

    <script>
        $(document).ready(function () {
            var studentData = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model, new Newtonsoft.Json.JsonSerializerSettings
            {
                ReferenceLoopHandling = Newtonsoft.Json.ReferenceLoopHandling.Ignore
            }));

            $("#studentGrid").jqGrid({
                datatype: 'local',
                data: studentData,
                colNames: ['Name', 'Age', 'Email', 'DOB', 'Gender', 'Hobbies', 'CDAC Center', 'Actions'],
                colModel: [
                    { name: 'Name', index: 'Name', width: 150 },
                    { name: 'Age', index: 'Age', width: 80 },
                    { name: 'Email', index: 'Email', width: 180 },
                    { name: 'DOB', index: 'DOB', width: 120 },
                    { name: 'Gender', index: 'Gender', width: 80 },
                    { name: 'Hobbies', index: 'Hobbies', width: 200 },
                    { name: 'CDAC_Center', index: 'CDAC_Center', width: 150 },
                    {
                        name: 'Actions',
                        index: 'Actions',
                        width: 200,
                        formatter: function (cellvalue, options, rowObject) {
                            return `<button onclick="showEdit('${rowObject.Id}')">Edit</button>
                                    <button class='deleteButton' onclick="showDelete('${rowObject.Id}')">Delete</button>`;
                        }
                    }
                ],
                viewrecords: true,
                width: 1000,
                height: 300,
                rowNum: 10,
                pager: '#pager',
                caption: 'Student Management'
            });

            // Enable pagination with left and right buttons
            $("#studentGrid").navGrid('#pager', {
                edit: false,
                add: false,
                del: false,
                search: false,
                refresh: true,
            });

            // Change the default text of pagination buttons to "..."
            setTimeout(() => {
                $(".ui-pg-button .ui-icon-seek-prev").html("<");
                $(".ui-pg-button .ui-icon-seek-next").html(">");
                $(".ui-pg-button .ui-icon-seek-first").html("<<");
                $(".ui-pg-button .ui-icon-seek-end").html(">>");
            }, 500);
        });

        function showEdit(studentId) {
            window.location.href = `/Student/Edit/${studentId}`;
        }
        function showDelete(studentId) {
            window.location.href = `/Student/Delete/${studentId}`;
        }
    </script>

    <style>
        .deleteButton {
            background-color: red;
            color: white;
            border: none;
            padding: 6px 12px;
            margin: 2px;
            cursor: pointer;
            border-radius: 4px;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 6px 12px;
            margin: 2px;
            cursor: pointer;
            border-radius: 4px;
        }

            button:hover {
                background-color: #0056b3;
            }

        /* Custom style for pagination with ... */
        .ui-pg-button {
/*            background-color: #007bff;*/
            color: black;
            border-radius: 5px;
            padding: 6px 12px;
            margin: 5px;
            cursor: pointer;
            font-size: 14px;
        }

            .ui-pg-button:hover {
               background-color: #0056b3;
            }
    </style>
}
